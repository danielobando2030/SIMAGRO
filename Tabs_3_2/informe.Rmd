--- 
title: ' '
params:
  producto: NA
  anio: NA
  mes: NA
  mensaje1: NA
  mensaje2: NA
  mapa_png: NA
  tabla_datos: NA
  logo_sup: NA
  logo_inf: NA

output:
  pdf_document:
    latex_engine: xelatex

header-includes:
  - \usepackage{float}
  - \usepackage{arydshln}
  - \usepackage{graphicx}
  - \usepackage{xcolor}
  - \usepackage{fontspec}
  - \usepackage{booktabs}
  - \usepackage{fancyhdr}
  - \usepackage{eso-pic}
  - \usepackage{colortbl}
  - \usepackage{adjustbox}
  - \setmainfont{Prompt-Regular.ttf}
  - \definecolor{mygreen}{RGB}{255,221,0}
  - \definecolor{MYGREEN}{RGB}{255,221,0}
  - \definecolor{grayA}{RGB}{78,77,77}
  - \definecolor{green2}{RGB}{255,221,0}
  - \pagestyle{fancy}
  - \fancyfoot{}
  - \fancyhead[C]{\includegraphics[width=\textwidth]{www/logo_3.png}}
  - \renewcommand{\headrule}{\color{mygreen}\hrule width\headwidth height\headrulewidth}
  - \setlength{\headheight}{2cm}
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
library(dplyr)
library(knitr)
library(kableExtra)
```

\begin{flushright}
\textcolor{mygreen}{Informe en línea generado el: `r format(Sys.Date(), "%d %B, %Y")`}
\end{flushright}

\section*{\textcolor{mygreen}{Parámetros con los cuales se generó el informe:}}

```{r, results='asis'}
opciones_mes <- c(
  "Enero"=1,"Febrero"=2,"Marzo"=3,"Abril"=4,"Mayo"=5,"Junio"=6,
  "Julio"=7,"Agosto"=8,"Septiembre"=9,"Octubre"=10,"Noviembre"=11,"Diciembre"=12
)

mes_label <- ifelse(is.na(params$mes),"Todos los meses",
                    names(opciones_mes)[opciones_mes == params$mes])

df_params <- data.frame(
  Parámetro = c("Año","Mes","Alimento"),
  Valor = c(
    ifelse(is.na(params$anio),"Todos los años", params$anio),
    mes_label,
    ifelse(params$producto=="todo","Todos los productos",params$producto)
  )
)

cat("\\small\\n")
cat("\\begin{adjustbox}{width=1\\textwidth}\\n")
cat("\\begin{tabular}{p{4cm} @{\\hspace{5cm}} p{6cm}}\\n")
cat("\\toprule\\n")

for (i in 1:nrow(df_params)) {
  cat(df_params$Parámetro[i], " & ", df_params$Valor[i], " \\\\\
", sep="")
}

cat("\\bottomrule\\n")
cat("\\end{tabular}\\n")
cat("\\end{adjustbox}\\n")
cat("\\normalsize\\n")
```

\fontsize{14}{14} \selectfont \textcolor{mygreen}{Diferencias de precios de alimentos con Bogotá}\\
\fontsize{12}{12} \selectfont \textcolor{mygreen}{Descubre los departamentos donde hay mayores y menores diferencias de precios en los alimentos con Bogotá y Cundinamarca}\\

```{r, out.width="90%",warning=FALSE,message=FALSE}
knitr::include_graphics(params$mapa_png)
```

\vspace{0.2cm}
\begingroup
\fontsize{8}{8}\selectfont
\textcolor{mygreen}{\textbf{Fuente:} Cálculos propios a partir de datos del Sistema de Información de Precios y Abastecimiento del Sector Agropecuario (SIPSA).}
\endgroup

\begingroup
\fontsize{10}{10}\selectfont 
\textcolor{grayA}`r params$mensaje1`
\endgroup

\vspace{0.2cm}

\begingroup
\fontsize{10}{10}\selectfont 
\textcolor{grayA}`r params$mensaje2`
\endgroup

\vspace{0.25cm}
\begingroup
\fontsize{8}{8}\selectfont
\textcolor{grayA}{Esta visualización compara los precios promedio de alimentos entre Bogotá y los demás departamentos del país, mostrando qué territorios registran mayores o menores valores relativos. Un valor mayor indica precios más altos con respecto a Bogotá, mientras que un valor menor indica precios más bajos comparando con la misma.}
\endgroup

\AddToShipoutPictureBG*{
  \includegraphics[width=\\paperwidth,height=3cm,keepaspectratio]{www/logo_2.png}
}
