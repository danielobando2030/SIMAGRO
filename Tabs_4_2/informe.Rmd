---
title: ' '
params:
  anio: NA
  mes: NA
  producto: NA
  datos: NA
  grafico_png: NA
  logo_sup: NA
  logo_inf: NA
  mensaje1: NA        # <<<<<<<<<< AÑADIDO
  mensaje2: NA        # <<<<<<<<<< AÑADIDO
output:
  pdf_document:
    latex_engine: xelatex

header-includes:
  - \usepackage{float}
  - \usepackage{arydshln}
  - \usepackage{graphicx}
  - \usepackage{xcolor}
  - \usepackage{fontspec}
  - \usepackage{booktabs}
  - \usepackage{fancyhdr}
  - \usepackage{eso-pic}
  - \usepackage{colortbl}
  - \usepackage{adjustbox}
  - \setmainfont{Prompt-Regular.ttf}
  - \definecolor{mygreen}{RGB}{78,77,77}
  - \definecolor{grayA}{RGB}{78,77,77}
  - \pagestyle{fancy}
  - \fancyfoot{}
  - \fancyhead[C]{\includegraphics[width=\textwidth]{www/logo_3.png}}
  - \renewcommand{\headrule}{\color{mygreen}\hrule width\headwidth height\headrulewidth}
  - \setlength{\headheight}{2cm}
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
library(dplyr)
library(knitr)
library(kableExtra)
library(leaflet)
library(htmlwidgets)
```

\begin{flushright}
\textcolor{mygreen}{Informe en línea generado el: `r format(Sys.Date(), "%d %B, %Y")`}
\end{flushright}


\section*{\textcolor{mygreen}{Parámetros con los cuales se generó el informe:}}

```{r, results='asis'}

# Año
anio_label <- params$anio

# Convertir mes a número y luego a nombre en español
mes_num <- suppressWarnings(as.integer(params$mes))

nombres_mes <- c(
  "Enero","Febrero","Marzo","Abril","Mayo","Junio",
  "Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"
)

mes_label <- ifelse(
  is.na(mes_num) | mes_num < 1 | mes_num > 12,
  as.character(params$mes),
  nombres_mes[mes_num]
)

# Alimento (antes: producto)
alim_label <- params$producto

# Construir tabla FAO: Año - Mes - Alimento
df_params <- data.frame(
  Parámetro = c("Año", "Mes", "Alimento"),
  Valor     = c(anio_label, mes_label, alim_label)
)

# ==== TABLA FAO SIN FLOATS, COMPLETAMENTE ESCAPADA =====
cat("\\begingroup\n")
cat("\\small\n")
cat("\\begin{adjustbox}{width=1\\textwidth}\n")
cat("\\begin{tabular}{p{4cm} @{\\hspace{5cm}} p{6cm}}\n")
cat("\\toprule\n")

for (i in 1:nrow(df_params)) {
  cat(df_params$Parámetro[i], " & ", df_params$Valor[i], " \\\\\n", sep = "")
}

cat("\\bottomrule\n")
cat("\\end{tabular}\n")
cat("\\end{adjustbox}\n")
cat("\\endgroup\n")

```

\begingroup
\fontsize{14}{14}\selectfont
\textcolor{mygreen}{Rutas de abastecimiento por regiones geográficas}
\par
\fontsize{12}{12}\selectfont
\textcolor{mygreen}{Descubre la importancia de las diferentes rutas de abastecimiento del país en Bogotá y Cundinamarca}
\par
\endgroup

```{r grafico_principal, echo=FALSE, message=FALSE, warning=FALSE, out.width="95%", fig.align="center"}
knitr::include_graphics(params$grafico_png)
```

\vspace{0.2cm}
\begingroup
\fontsize{8}{8}\selectfont
\textcolor{mygreen}{\textbf{Fuente:} Cálculos propios a partir de datos del Sistema de Información de Precios y Abastecimiento del Sector Agropecuario (SIPSA).}
\endgroup

\vspace{0.2cm}

\begingroup
\fontsize{10}{10}\selectfont
\textcolor{grayA}{`r params$mensaje1`}
\endgroup

\vspace{0.25cm}

\begingroup
\fontsize{10}{10}\selectfont
\textcolor{grayA}{`r params$mensaje2`}
\endgroup

\vspace{0.45cm}

\newpage

\begingroup
\fontsize{8}{8}\selectfont
\textcolor{grayA}{
Esta visualización permite ver las rutas más importantes por donde se transportan los alimentos hacia Bogotá y Cundinamarca}
\endgroup

\vspace*{4cm}

\AddToShipoutPictureBG*{
  \includegraphics[width=\paperwidth,height=3cm,keepaspectratio]{www/logo_4.png}
}




